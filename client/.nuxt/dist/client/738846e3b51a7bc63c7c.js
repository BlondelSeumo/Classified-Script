(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{594:function(t,e,n){"use strict";n.r(e);n(47);var o,r=n(27),l={layout:"default/manager",middleware:"auth",asyncData:(o=Object(r.a)(regeneratorRuntime.mark((function t(e){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.app,n=e.$axios,e.redirect,t.next=3,n.get("manager/messages");case 3:return o=t.sent,t.abrupt("return",{messagesData:o.data,messages:o.data.data});case 5:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)}),data:function(){return{selected:[],headers:[{text:"From",sortable:!1},{text:"Deal",sortable:!1},{text:"Message",sortable:!1},{text:"Status",sortable:!1},{text:"Created",sortable:!1},{text:"Options",sortable:!1}],dialogs:{delete:!1,read:!1},message:{index:null,content:null},loading:!1}},head:function(){return{title:"Notification center",titleTemplate:"%s ".concat(this.$store.state.settings.separator," ").concat(this.$t("t_dashboard")),meta:[{name:"robots",content:"noindex, nofollow"}],link:[{rel:"icon",type:"image/x-icon",href:this.$store.state.settings.favicon?this.$homeApi("storage/app/".concat(this.$store.state.settings.favicon)):this.$homeApi("storage/app/uploads/default/settings/favicon/favicon.png")}]}},methods:{getNextPage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,this.$axios.get("manager/messages?page="+e).then((function(e){t.selected=[],t.messagesData=e.data,t.messages=e.data.data,t.loading=!1}))},avatar:function(t){return null===t?this.$homeApi("storage/app/uploads/default/avatar/noavatar.png"):this.$homeApi("storage/app/"+t)},preview:function(t){return 0==t.photosNumber?this.$homeApi("storage/app/uploads/default/classifieds/no-image.png"):this.$homeApi("storage/app/uploads/classifieds/"+t.unique_id+"/preview_0.jpg")},show:function(t,e){this.message.index=e,this.message.content=t.message,this.dialogs.read=!0},remove:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selected,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=this;o.loading=!0,this.$axios.post("manager/messages/options/delete",{messages:e}).then((function(r){null!==n?t.messages.splice(n,1):o.selected.forEach((function(t,e){o.messages.forEach((function(e,n){t.unique_id===e.unique_id&&o.messages.splice(n,1)}))})),o.$toasted.show("Selected ".concat(e.length>1?"messages":"message"," has been successfully deleted permanently"),{icon:"done_all"}),o.dialogs.delete=!1,o.loading=!1})).catch((function(e){console.log(e),o.$toasted.error(t.$t("t_toasted_something_went_wrong"),{icon:"error",action:null}),o.loading=!1}))}}},c=n(52),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"inspire"}},[n("v-dialog",{attrs:{persistent:"","elevation-0":"",width:"100","content-class":"elevation-0"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("v-card",{attrs:{flat:""}},[n("v-card-text",{staticClass:"pa-4 text-center"},[n("v-progress-circular",{attrs:{size:45,width:"2",color:"light-blue",indeterminate:""}})],1)],1)],1),t._v(" "),n("v-container",[n("div",{staticClass:"m-card"},[n("v-toolbar",{staticClass:"elevation-0",attrs:{color:"white"}},[n("v-toolbar-title",[t._v("Notifications")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-fade-transition",[t.selected.length>0?n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",flat:"",icon:""},on:{click:function(e){t.dialogs.delete=!0}},slot:"activator"},[n("v-icon",[t._v("mdi-delete")])],1),t._v(" "),n("span",[t._v("Delete")])],1):t._e()],1)],1),t._v(" "),n("v-data-table",{attrs:{headers:t.headers,items:t.messages,"item-key":"id","hide-actions":"","show-select":"","disable-pagination":""},scopedSlots:t._u([{key:"items",fn:function(e){return[n("td",[n("v-checkbox",{attrs:{color:"grey darken-1","hide-details":""},model:{value:e.selected,callback:function(n){t.$set(e,"selected",n)},expression:"props.selected"}})],1),t._v(" "),n("td",{staticClass:"text-center"},[n("nuxt-link",{attrs:{to:"/administrator/users/edit/"+e.item.sender.username,target:"_blank"}},[n("v-avatar",{attrs:{size:"36px"}},[n("img",{attrs:{src:t.avatar(e.item.sender.avatar)}})])],1)],1),t._v(" "),n("td",{staticClass:"text-center product-link"},[n("v-list",{staticClass:"transparent",attrs:{"two-line":""}},[n("v-list-item",{attrs:{to:"/listing/"+e.item.deal.unique_slug,target:"_blank"}},[n("v-list-item-avatar",[n("img",{attrs:{src:t.preview(e.item.deal)}})]),t._v(" "),n("v-list-item-content",[n("v-list-item-title",{staticClass:"table-wrap-title",domProps:{innerHTML:t._s(e.item.deal.title)}})],1)],1)],1)],1),t._v(" "),n("td",{staticClass:"text-center"},[n("v-btn",{attrs:{text:"",color:"grey darken-3",icon:""},on:{click:function(n){return t.show(e.item,e.index)}}},[n("v-icon",[t._v("mdi-android-messages")])],1)],1),t._v(" "),n("td",{staticClass:"text-center"},[e.item.isRead?n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",flat:"",color:"#22a7f0",icon:""},slot:"activator"},[n("v-icon",[t._v("mdi-eye")])],1),t._v(" "),n("span",[t._v("User has seen this message")])],1):n("v-tooltip",{attrs:{top:""}},[e.item.isRead?t._e():n("v-btn",{attrs:{slot:"activator",flat:"",color:"grey darken-3",icon:""},slot:"activator"},[n("v-icon",[t._v("mdi-eye-off")])],1),t._v(" "),n("span",[t._v("User has not seen this message yet")])],1)],1),t._v(" "),n("td",{staticClass:"text-center"},[t._v(t._s(t.$ago(e.item.created_at)))]),t._v(" "),n("td",{staticClass:"text-center"},[n("v-btn",{attrs:{small:"",icon:""},on:{click:function(n){return t.remove([e.item],e.index)}}},[n("v-icon",{attrs:{size:"18px",color:"grey darken-1"}},[t._v("mdi-delete")])],1)],1)]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),t._v(" "),n("div",{staticClass:"text-center pt-2"},[n("pagination",{attrs:{data:t.messagesData,limit:8},on:{"pagination-change-page":t.getNextPage}},[n("span",{attrs:{slot:"prev-nav"},slot:"prev-nav"},[n("i",{staticClass:"v-icon material-icons theme--light",attrs:{"aria-hidden":"true"}},[t._v("chevron_left")])]),t._v(" "),n("span",{attrs:{slot:"next-nav"},slot:"next-nav"},[n("i",{staticClass:"v-icon material-icons theme--light",attrs:{"aria-hidden":"true"}},[t._v("chevron_right")])])])],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);