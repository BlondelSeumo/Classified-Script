(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{598:function(t,e,n){"use strict";n.r(e);var r,o,l=n(99),c=(n(45),n(26)),d={layout:"default/manager",middleware:"manager",asyncData:(o=Object(c.a)(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.app,n=e.$axios,e.redirect,t.next=3,n.get("manager/messages");case 3:return r=t.sent,t.abrupt("return",{messagesData:r.data,messages:r.data.data});case 5:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)}),data:function(){return{form:{message:null},dialogs:{reply:!1,read:!1},message:{index:null,content:null,message:null},loading:!1}},head:function(){return{title:this.$t("t_message_center"),titleTemplate:"%s ".concat(this.$store.state.settings.separator," ").concat(this.$t("t_dashboard")),meta:[{name:"robots",content:"noindex, nofollow"}],link:[{rel:"icon",type:"image/x-icon",href:this.$store.state.settings.favicon?this.$homeApi("storage/app/".concat(this.$store.state.settings.favicon)):this.$homeApi("storage/app/uploads/default/settings/favicon/favicon.png")}]}},computed:{headers:function(){return[{text:this.$t("t_shop"),value:"shop",sortable:!1,align:this.$vuetify.rtl?"right":"left"},{text:this.$t("t_from"),value:"from",sortable:!1,align:this.$vuetify.rtl?"right":"left"},{text:this.$t("t_subject"),value:"subject",sortable:!1,align:this.$vuetify.rtl?"right":"left"},{text:this.$t("t_sent_at"),value:"sent",sortable:!1,align:"center"},{text:this.$t("t_options"),value:"options",sortable:!1,align:"center"}]}},methods:{getNextPage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,this.$axios.get("manager/messages?page="+e).then((function(e){t.selected=[],t.messagesData=e.data,t.messages=e.data.data,void 0!==("undefined"==typeof window?"undefined":Object(l.a)(window))&&window.scrollTo(0,0),t.loading=!1}))},read:(r=Object(c.a)(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isRead){t.next=3;break}return t.next=3,this.$axios.post("manager/messages/options/read",{id:e.unique_id});case 3:this.message.content=e.message,this.message.index=n,this.messages[n].isRead=!0,this.dialogs.read=!0;case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)}),reply:function(t,e){this.message.message=t,this.message.index=e,this.dialogs.reply=!0},send:function(){var t=this;this.form.message&&(this.loading=!0,this.$axios.post("manager/messages/options/reply",{id:this.message.message.unique_id,message:this.form.message}).then((function(e){t.$toasted.show(t.$t("t_toasted_message_sent"),{icon:"done_all",className:t.$vuetify.rtl?"toasted-rtl":""}),t.messages[t.message.index].isReplied=!0,t.loading=!1,t.dialogs.reply=!1,t.message.index=null,t.message.content=null,t.message.message=null})).catch((function(e){t.$toasted.error(t.$t("t_toasted_something_went_wrong"),{icon:"error",className:t.$vuetify.rtl?"toasted-rtl":""}),t.loading=!1,t.dialogs.reply=!1})))},logo:function(t){return null===t?this.$homeApi("storage/app/uploads/default/store/no-logo.png"):this.$homeApi("storage/app/"+t)}}},m=n(52),component=Object(m.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"inspire"}},[n("v-overlay",{attrs:{opacity:"0.8"},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"80",width:"4",color:"white"}},[t._v("\n\t\t\t\t"+t._s(t.$t("t_loading"))+"\n\t\t\t")])],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"500px",persistent:""},model:{value:t.dialogs.reply,callback:function(e){t.$set(t.dialogs,"reply",e)},expression:"dialogs.reply"}},[n("v-card",{staticClass:"pa-2"},[n("v-card-title",{staticClass:"pt-1",attrs:{"primary-title":""}},[n("h3",{staticClass:"body-2 mb-0 text-uppercase font-weight-black"},[t._v(t._s(t.$t("t_reply")))]),t._v(" "),n("v-spacer"),t._v(" "),t.message.message&&t.message.message.isReplied?n("v-btn",{staticClass:"px-3",attrs:{small:"",depressed:""}},[t._v("\n\t\t\t\t\t\t"+t._s(t.$t("t_already_replied"))+"\n\t\t\t\t\t")]):t._e(),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogs.reply=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1),t._v(" "),n("v-card-text",[n("v-container",{staticClass:"pa-0",attrs:{"grid-list-md":""}},[n("v-layout",{attrs:{wrap:""}},[n("v-flex",{attrs:{xs12:""}},[n("v-textarea",{attrs:{color:"grey lighten-1",label:t.$t("t_message"),placeholder:t.$t("t_enter_message"),counter:"500",maxlength:"500","no-resize":"",required:""},model:{value:t.form.message,callback:function(e){t.$set(t.form,"message",e)},expression:"form.message"}})],1)],1)],1)],1),t._v(" "),n("v-card-actions",{staticClass:"pa-2"},[n("v-spacer"),t._v(" "),n("client-only",[n("v-btn",{attrs:{color:"#2e3131",flat:"",disabled:!t.form.message},on:{click:t.send}},[t._v(t._s(t.$t("t_send")))])],1)],1)],1)],1),t._v(" "),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialogs.read,callback:function(e){t.$set(t.dialogs,"read",e)},expression:"dialogs.read"}},[n("v-card",{staticClass:"pa-3"},[n("v-card-title",{staticClass:"pt-1",attrs:{"primary-title":""}},[n("h3",{staticClass:"body-2 mb-0 text-uppercase font-weight-black"},[t._v(t._s(t.$t("t_read_message")))]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.dialogs.read=!1}}},[n("v-icon",[t._v("mdi-close")])],1)],1),t._v(" "),n("v-card-text",{domProps:{innerHTML:t._s(t.message.content)}})],1)],1),t._v(" "),n("v-container",[n("div",{staticClass:"m-card"},[n("v-toolbar",{attrs:{flat:""}},[n("v-toolbar-title",[t._v(t._s(t.$t("t_message_center")))])],1),t._v(" "),n("v-data-table",{attrs:{headers:t.headers,items:t.messages,"item-key":"id","hide-default-footer":"","disable-pagination":"","no-data-text":t.$t("t_table_no_data_available"),"mobile-breakpoint":1},scopedSlots:t._u([{key:"item.shop",fn:function(e){var r=e.item;return[n("v-list",{staticClass:"transparent",attrs:{"two-line":""}},[n("v-list-item",{attrs:{to:"/shop/"+r.shop.store,target:"_blank",nuxt:"",ripple:!1}},[n("v-list-item-avatar",[n("img",{attrs:{src:t.logo(r.shop.logo)}})]),t._v(" "),n("v-list-item-content",[n("v-list-item-title",{staticClass:"table-wrap-title",domProps:{innerHTML:t._s(r.shop.title)}})],1)],1)],1)]}},{key:"item.from",fn:function(e){var n=e.item;return[t._v("\n\t\t\t\t\t\t"+t._s(n.sender.username)+"\n\t\t\t\t\t")]}},{key:"item.subject",fn:function(e){var r=e.item;return[n("div",{class:r.isRead?"font-weight-regular":"font-weight-black"},[n("span",{staticClass:"cursor-pointer",on:{click:function(e){t.read(r,t.messages.indexOf(r))}}},[t._v(t._s(r.subject))])])]}},{key:"item.sent",fn:function(e){var n=e.item;return[t._v(t._s(t.$ago(n.created_at)))]}},{key:"item.options",fn:function(e){var r=e.item;return[n("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[n("v-btn",t._g({attrs:{small:"",icon:""},on:{click:function(e){t.reply(r,t.messages.indexOf(r))}}},o),[n("v-icon",{attrs:{size:"18px",color:t.$vuetify.theme.dark?"white":"grey darken-1"}},[t._v("mdi-reply")])],1)]}}],null,!0)},[t._v(" "),n("span",[t._v(t._s(t.$t("t_reply")))])])]}}])})],1),t._v(" "),n("div",{staticClass:"text-center pt-2"},[n("pagination",{attrs:{data:t.messagesData,limit:8,align:t.$vuetify.rtl?"left":"right"},on:{"pagination-change-page":t.getNextPage}},[n("span",{attrs:{slot:"prev-nav"},slot:"prev-nav"},[n("i",{staticClass:"v-icon material-icons theme--light",attrs:{"aria-hidden":"true"}},[t._v(t._s(t.$vuetify.rtl?"chevron_right":"chevron_left"))])]),t._v(" "),n("span",{attrs:{slot:"next-nav"},slot:"next-nav"},[n("i",{staticClass:"v-icon material-icons theme--light",attrs:{"aria-hidden":"true"}},[t._v(t._s(t.$vuetify.rtl?"chevron_left":"chevron_right"))])])])],1)])],1)}),[],!1,null,null,null);e.default=component.exports}}]);