exports.ids=[4],exports.modules={152:function(e,t,r){"use strict";r.r(t);var o=r(76),l=r(68),n=r.n(l),c=(r(77),r(78),r(69)),d=r.n(c),f=r(70),h=r.n(f);const m=n()(d.a,h.a);var v={middleware:"auth",layout:"default/main",components:{"v-sidebar":o.a,FilePond:m},async asyncData({$axios:e,params:t,query:r}){let o=await e.post("account/deals/options/edit",{id:t.id,package:r.package});return{form:{currency:o.data.deal.currency,title:o.data.deal.title,description:o.data.deal.description,price:o.data.deal.price,category:o.data.deal.category_id,sub_cat:o.data.deal.category_id,video:o.data.deal.video,images:[],fields:o.data.formFields},fields:o.data.fields,countries:o.data.countries,currencies:o.data.currencies,categories:o.data.parents,childs:o.data.subs,packages:o.data.packages,deal:o.data.deal,seo:{title:o.data.seo.title,separator:o.data.seo.separator,description:o.data.seo.description,favicon:o.data.seo.favicon}}},data:()=>({errors:[],dialogs:{currency:!1},server:{url:process.env.SERVER_URL,process:!1,load:(source,e,t)=>{fetch(source).then(e=>e.blob()).then(e)}},loading:!0}),head(){return{title:this.$t("t_edit_deal_title",{title:this.deal.title}),titleTemplate:`%s ${this.seo.separator} ${this.seo.title}`,meta:[{name:"description",content:this.seo.description},{name:"robots",content:"noindex, nofollow"}],link:[{rel:"icon",type:"image/x-icon",href:this.seo.favicon}]}},methods:{update(){try{this.loading=!0;let e=JSON.stringify(this.form.fields),data=new FormData;data.append("id",this.deal.unique_id),data.append("title",this.form.title),this.form.description&&data.append("description",this.form.description),this.form.video&&data.append("video",this.form.video),this.form.price&&data.append("price",this.form.price),this.form.category&&data.append("category",this.form.category),this.form.sub_cat&&data.append("sub_cat",this.form.sub_cat),this.form.currency&&data.append("currency",this.form.currency),data.append("fields",e);for(let i=0;i<this.$refs.pond.getFiles().length;i++)"image/jpeg"!==this.$refs.pond.getFiles()[i].file.type&&"image/png"!==this.$refs.pond.getFiles()[i].file.type||data.append("images[]",this.$refs.pond.getFiles()[i].file);this.$axios.post("account/deals/options/update",data,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{if(this.errors=[],"approval_required"===e.data)return this.$toasted.success(this.$t("t_toasted_deal_requires_approval"),{icon:"sync",className:this.$vuetify.rtl?"toasted-rtl":""}),this.loading=!1,void this.$router.push("/account/deals");this.$toasted.show(this.$t("t_toasted_your_deal_edited"),{icon:"done_all",className:this.$vuetify.rtl?"toasted-rtl":""}),this.$router.push(e.data),this.loading=!1}).catch(e=>{e.response.data.errors&&(this.errors=e.response.data.errors),this.$toasted.error(this.$t("t_toasted_something_went_wrong"),{icon:"error",className:this.$vuetify.rtl?"toasted-rtl":""}),this.loading=!1})}catch(e){this.$toasted.error(this.$t("t_toasted_something_went_wrong"),{icon:"error",className:this.$vuetify.rtl?"toasted-rtl":""}),this.loading=!1}},changeCurrency:function(){this.dialogs.currency=!this.dialogs.currency},fetchFields:function(e=!1){this.form.fields=[],this.loading=!0;let t=e?this.form.sub_cat:this.form.category;this.$axios.post("ajax/fetch/fields",{category:t}).then(e=>{this.fields=e.data,this.loading=!1}).catch(e=>{console.log(e),this.loading=!1})},fetchChilds:function(){this.loading=!0,this.$axios.post("ajax/fetch/categories/childs",{id:this.form.category}).then(e=>{0===e.data.length?(this.form.sub_cat=null,this.childs=[]):this.childs=e.data,this.loading=!1}).catch(e=>{console.log(e),this.loading=!1})},fetchSubs:function(){this.loading=!0,this.$axios.post("ajax/fetch/categories/childs",{id:this.form.sub_cat}).then(e=>{if(0!==e.data.length){let t=this.form.sub_cat;this.form.sub_cat=null,this.$nextTick(()=>{this.childs=e.data,this.form.sub_cat=t})}this.loading=!1}).catch(e=>{console.log(e),this.loading=!1})},addDropdownField:function(e,t){let r=this,data={slug:t,value:e};if(0===r.form.fields.length)r.form.fields.push(data);else{if(r.form.fields.some(a=>a.slug===t)){for(var o in r.form.fields){let l=r.form.fields[o];if(l.slug===t){l.value=e;break}}return}r.form.fields.push(data)}},addCheckboxField:function(e,t,r){let o=this,data={slug:t,value:[e]};if(0===o.form.fields.length)o.form.fields.push(data);else{if(o.form.fields.some(a=>a.slug===t)){for(var l in o.form.fields){let c=o.form.fields[l];if(c.slug===t){let t=c.value;for(var n in 0===t.length&&t.push(e),t){let t=o.form.fields[l].value[n];if(null===e&&t===r){o.$delete(o.form.fields[l].value,n);break}if(null!==e&&r!==t){o.form.fields[l].value.push(e);break}}break}}return}o.form.fields.push(data)}},addRadioField:function(e,t){let r=this,data={slug:t,value:e};if(0===r.form.fields.length)r.form.fields.push(data);else{if(r.form.fields.some(a=>a.slug===t)){for(var o in r.form.fields){let l=r.form.fields[o];if(l.slug===t){l.value=e;break}}return}r.form.fields.push(data)}},fieldValue(e,t=null,r,o=null){if(0!==this.form.fields.length)if("checkbox"===t){let t=this.form.fields.find((function(element){return element.slug===e}));if(t){return t.value.find((function(element){return element===o}))}}else{let t=this.form.fields.find((function(element){return element.slug===e}));if(t)return t.value}},fetchImages(){if(this.deal.photosNumber)for(let e=0;e<this.deal.photosNumber;e++){let image={source:this.$homeApi(`api/fetch/image/${this.deal.unique_id}-preview_${e}.jpg?v=${Math.random()}`),options:{type:"local"}};this.form.images.push(image)}}},mounted(){0}},_=r(1),component=Object(_.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"inspire"}},[r("v-overlay",{attrs:{opacity:"0.8"},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[r("v-progress-circular",{attrs:{indeterminate:"",size:"80",width:"4",color:"white"}},[e._v("\n\t\t\t\t"+e._s(e.$t("t_loading"))+"\n\t\t\t")])],1),e._v(" "),r("v-content",[r("v-container",{attrs:{"grid-list-xl":"",fluid:""}},[r("v-layout",{attrs:{wrap:"","fill-height":""}},[r("v-flex",{attrs:{xs12:""}},[r("v-card",{staticClass:"m-card mb-4",attrs:{flat:""}},[r("v-card-title",{staticClass:"text-center pa-5",attrs:{"primary-title":""}},[r("div",{staticClass:"text-center",staticStyle:{width:"100%"}},[r("v-icon",{attrs:{color:"grey darken-1",size:"80"}},[e._v("mdi-image-multiple")])],1)]),e._v(" "),r("v-container",{staticClass:"pa-4",attrs:{"grid-list-xl":"",fluid:""}},[r("v-layout",{attrs:{wrap:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"grey lighten-1",label:e.$t("t_title"),placeholder:e.$t("t_enter_title"),counter:"100",maxlength:"100",rules:e.errors.title,error:!!e.errors.title},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("div",{staticClass:"form-group mb-4",class:[e.errors.description?"has-danger":""]},[r("label",{attrs:{for:"input-normal"}},[e._v(e._s(e.$t("t_description")))]),e._v(" "),r("ckeditor",{staticClass:"form-control",attrs:{config:{language:this.$i18n.locale},type:"classic"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),e.errors.description?r("small",{staticClass:"red--text block"},[e._v(e._s(e.errors.description[0]))]):e._e()]),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-autocomplete",{attrs:{items:e.categories,"item-text":"title","item-value":"id",label:e.$t("t_category"),placeholder:e.$t("t_choose_category"),autocomplete:"off",color:"grey lighten-1",rules:e.errors.category,error:!!e.errors.category,dense:""},on:{change:function(t){e.fetchFields(),e.fetchChilds()}},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),e._v(" "),0!==e.childs.length?r("v-flex",{attrs:{xs12:""}},[r("v-autocomplete",{attrs:{items:e.childs,"item-text":"title","item-value":"id",label:e.$t("t_sub_category"),placeholder:e.$t("t_choose_sub_category"),autocomplete:"off",color:"grey lighten-1",rules:e.errors.sub_cat,error:!!e.errors.sub_cat,dense:""},on:{change:function(t){e.fetchFields(!0),e.fetchSubs()}},model:{value:e.form.sub_cat,callback:function(t){e.$set(e.form,"sub_cat",t)},expression:"form.sub_cat"}})],1):e._e(),e._v(" "),e._l(e.fields,(function(t){return r("div",{key:t.id,staticStyle:{width:"100%"}},["dropdown"===t.field.type?r("v-flex",{attrs:{xs12:""}},[r("v-select",{attrs:{value:e.fieldValue(t.field.slug),items:t.field.options.split(","),placeholder:t.field.name,label:t.field.name,autocomplete:"off",color:"grey lighten-1",rules:e.errors[t.field.slug],error:!!e.errors[t.field.slug],dense:""},on:{change:function(r){return e.addDropdownField(r,t.field.slug)}}})],1):e._e(),e._v(" "),"checkbox"===t.field.type?r("v-flex",{attrs:{xs12:""}},[r("div",{class:e.errors[t.field.slug]?"error--text":""},[e._v(e._s(t.field.name))]),e._v(" "),e._l(t.field.options.split(","),(function(o,l){return r("v-checkbox",{key:l,staticClass:"mb-3",attrs:{label:o,color:"red",value:o,"hide-details":"","input-value":e.fieldValue(t.field.slug,t.field.type,l,o)},on:{change:function(r){return e.addCheckboxField(r,t.field.slug,o)}}})})),e._v(" "),e.errors[t.field.slug]?r("small",{staticClass:"error--text"},[e._v(e._s(e.errors[t.field.slug][0]))]):e._e()],2):e._e(),e._v(" "),"radio"===t.field.type?r("v-flex",{attrs:{xs12:""}},[r("div",{class:e.errors[t.field.slug]?"error--text":""},[e._v(e._s(t.field.name))]),e._v(" "),r("v-radio-group",{attrs:{column:"",value:e.fieldValue(t.field.slug)}},[e._l(t.field.options.split(","),(function(o){return r("v-radio",{key:o,staticClass:"mb-3",attrs:{label:o,color:"red",value:o,"hide-details":""},on:{change:function(r){return e.addRadioField(o,t.field.slug)}}})})),e._v(" "),e.errors[t.field.slug]?r("small",{staticClass:"error--text"},[e._v(e._s(e.errors[t.field.slug][0]))]):e._e()],2)],1):e._e()],1)})),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"grey lighten-1",label:e.$t("t_price"),placeholder:e.$t("t_enter_price"),prefix:e.$currencySymbol(e.form.currency),"append-icon":"mdi-dots-vertical",rules:e.errors.price,error:!!e.errors.price},on:{"click:append":e.changeCurrency},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),e._v(" "),e.dialogs.currency?r("v-flex",{attrs:{xs12:""}},[r("v-autocomplete",{attrs:{autocomplete:"off",color:"grey lighten-1",items:e.currencies,"item-text":"name","item-value":"code",placeholder:e.$t("t_enter_currency"),label:e.$t("t_currency"),dense:""},on:{change:function(t){e.dialogs.currency=!e.dialogs.currency}},model:{value:e.form.currency,callback:function(t){e.$set(e.form,"currency",t)},expression:"form.currency"}})],1):e._e(),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-text-field",{attrs:{color:"grey lighten-1",label:e.$t("t_youtube_video"),placeholder:e.$t("t_enter_youtube_video"),rules:e.errors.video,error:!!e.errors.video},model:{value:e.form.video,callback:function(t){e.$set(e.form,"video",t)},expression:"form.video"}})],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("client-only",[r("div",[r("div",[r("file-pond",{ref:"pond",attrs:{name:"test","label-idle":e.$t("t_drag_deal_images_mobile"),"allow-multiple":"true","accepted-file-types":"image/jpeg, image/png",server:e.server,files:e.form.images}})],1)])])],1),e._v(" "),r("v-flex",{attrs:{xs12:""}},[r("v-btn",{staticClass:"mb-1",attrs:{disabled:e.loading,loading:e.loading,block:"",depressed:"",color:"blue",dark:""},on:{click:function(t){return t.preventDefault(),e.update(t)}}},[e._v(e._s(e.$t("t_update")))])],1)],2)],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,"d156083e");t.default=component.exports},72:function(e,t){},73:function(e,t){},74:function(e,t,r){"use strict";r.r(t);var o=r(72),l=r.n(o);for(var n in o)"default"!==n&&function(e){r.d(t,e,(function(){return o[e]}))}(n);t.default=l.a},75:function(e,t,r){"use strict";r.r(t);var o=r(73),l=r.n(o);for(var n in o)"default"!==n&&function(e){r.d(t,e,(function(){return o[e]}))}(n);t.default=l.a},76:function(e,t,r){"use strict";var o={name:"sidebar",middleware:"auth",layout:"default/main",data:function(){return{items:[{icon:"mdi-settings",title:"t_account_settings",to:"/account/settings",enabled:!0},{icon:"mdi-image-multiple",title:"t_my_deals",to:"/account/deals",enabled:!0},{icon:"mdi-message",title:"t_message_center",to:"/account/messages",enabled:this.$megate.allow(this.$auth.user,"receive","messages")},{icon:"mdi-tag",title:"t_received_offers",to:"/account/offers",enabled:this.$megate.allow(this.$auth.user,"receive","offers")},{icon:"mdi-folder-search",title:"t_saved_search",to:"/account/search",enabled:this.$megate.allow(this.$auth.user,"save","search")},{icon:"mdi-store",title:"t_following_shops",to:"/account/following",enabled:this.$megate.allow(this.$auth.user,"follow","shops")},{icon:"mdi-wallet-membership",title:"t_membership",to:"/account/subscription",enabled:!0},{divider:!0},{icon:"mdi-two-factor-authentication",title:"t_two_factor_auth",to:"/account/2fa",enabled:!0}]}},methods:{async logout(){await this.$auth.logout(),this.$router.push({name:"mainIndex"})}}},l=r(1);var component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-flex",{staticClass:"user-area",attrs:{xs3:""}},[r("v-navigation-drawer",{staticClass:"m-card pb-3",staticStyle:{height:"auto"},attrs:{width:"auto"}},[r("v-list",{staticClass:"user-sidebar",attrs:{dense:""}},[e._l(e.items,(function(t,o){return[t.divider?r("v-divider",{key:t.to}):e._e(),e._v(" "),t.divider?e._e():r("nuxt-link",{key:o,attrs:{to:t.to,tag:"v-list-item","active-class":"active-item"}},[r("v-list-item",[r("v-list-item-action",[r("v-icon",{staticClass:"v-icon theme--light mdi",class:t.icon})],1),e._v(" "),r("v-list-item-title",{directives:[{name:"t",rawName:"v-t",value:t.title,expression:"item.title"}]})],1)],1)]})),e._v(" "),r("v-list-item",{staticClass:"user-signout",on:{click:function(t){return t.preventDefault(),e.logout()}}},[r("v-list-item-action",[r("v-icon",{staticClass:"v-icon theme--light mdi mdi-logout"})],1),e._v(" "),r("v-list-item-title",[e._v(e._s(e.$t("t_sign_out")))])],1)],2)],1)],1)}),[],!1,(function(e){var t=r(74);t.__inject__&&t.__inject__(e);var o=r(75);o.__inject__&&o.__inject__(e)}),"7a304184","9f11acc2");t.a=component.exports},77:function(e,t){},78:function(e,t){}};